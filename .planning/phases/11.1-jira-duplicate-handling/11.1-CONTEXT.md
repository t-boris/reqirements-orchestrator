# Phase 11.1: Jira Duplicate Handling - Context

**Gathered:** 2026-01-15
**Status:** Ready for planning

<vision>
## How This Should Work

When MARO finds a potential duplicate ticket, it doesn't just warn ‚Äî it explains WHY it thinks there's a match and offers clear actions.

**The duplicate detection message:**
```
üîç Possible existing ticket found

I found a Jira ticket that looks very similar to what we're discussing:
‚Ä¢ PROJ-1234 ‚Äî "Scheduled notifications with edit/cancel support"
  Status: In Progress
  Created by: Alex
  Last updated: 3 days ago

This matches because:
‚Ä¢ same feature area (notifications)
‚Ä¢ same main action (scheduling)
‚Ä¢ same entities (user, date/time)

What would you like to do?

[‚úÖ Yes, this is it ‚Üí link thread]
[‚ûï No, create a new ticket]
[üß© Add this as extra info to PROJ-1234]
[üîç Show more matches]
```

**Matching logic:** Hybrid approach ‚Äî text search finds candidates, LLM explains why they match semantically.

**Multiple matches:** Best match shown first. "Show more matches" opens a Slack modal with all matches. Users can take actions (Link/Add Info) directly in the modal.

**After linking:** Simple confirmation: "‚úÖ Linked to PROJ-1234. I'll keep you posted on updates."

**Two-step flow:** First decide Link vs Create, THEN (in future phases) handle comment vs description contributions.

</vision>

<essential>
## What Must Be Nailed

- **Smart matching with explanation** ‚Äî The bot explains WHY it thinks there's a match (same feature area, same action, same entities), not just THAT there's a match
- **Clear, distinct actions** ‚Äî Users always know exactly what each button will do
- **Best match first** ‚Äî Don't overwhelm with 5 matches. Show the best one, offer "Show more"

</essential>

<specifics>
## Specific Ideas

- Match explanation uses semantic understanding: "same feature area", "same main action", "same entities"
- Modal for "Show more matches" keeps thread clean
- Full action buttons in modal ‚Äî users can link directly from there
- Unlink available from ticket status cards in thread

</specifics>

<notes>
## Additional Context

**This is Phase 11.1 MVP. Broader vision split across future phases:**

- **Phase 11.1 (this):** Duplicate detection + Link/Create choice
- **Phase 11.3:** Channel Jira Board + Comment vs Description actions
- **Phase 11.4:** Full bidirectional sync (Jira‚ÜíSlack updates)

**Broader philosophy (for future phases):**
- Channel = project, Thread = conversation
- Channel has a pinned "Jira Board" message showing all linked tickets
- Threads contribute to channel's Jira state, don't store their own "passport"
- MARO as requirements editor: Comments = stream of thoughts, Description = curated truth
- Never write to Jira without explicit consent

**Thread binding model (future):**
```
ThreadBindings = [
  { issue_key: "PROJ-1234", role: "primary" },
  { issue_key: "PROJ-5678", role: "related" }
]
```

</notes>

---

*Phase: 11.1-jira-duplicate-handling*
*Context gathered: 2026-01-15*
