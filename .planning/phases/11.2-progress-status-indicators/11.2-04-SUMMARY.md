---
phase: 11.2-progress-status-indicators
plan: 04
subsystem: ui
tags: [slack, progress, error-handling, retry, jira, asyncio]

# Dependency graph
requires:
  - phase: 11.2-01
    provides: ProgressTracker core with timing-based status
  - phase: 11.2-02
    provides: Skill-specific status messages and bottleneck identification
provides:
  - Error state methods (set_error, set_failure) in ProgressTracker
  - Progress callback support in JiraService for retry visibility
  - Error action buttons (Retry, Skip, Cancel) after Jira failures
affects: [11.2-03]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Progress callback pattern for retry visibility"
    - "Error action buttons for user recovery options"
    - "Factual error messaging (no apologies)"

key-files:
  created: []
  modified: [src/slack/progress.py, src/jira/client.py, src/slack/handlers.py, src/skills/jira_create.py]

key-decisions:
  - "Progress callback as optional parameter (backward compatible)"
  - "Error messages use factual tone per CONTEXT.md"
  - "Failure status persists (not auto-deleted) for user visibility"
  - "Action buttons offered after all retries exhausted"

patterns-established:
  - "set_error(error_type, service, attempt, max_attempts) for transient errors"
  - "set_failure(service, error_msg) for permanent failures"
  - "progress_callback(error_type, attempt, max_attempts) for async retry notification"

issues-created: []

# Metrics
duration: 8 min
completed: 2026-01-15
---

# Phase 11.2 Plan 04: Error Handling Protocol Summary

**Error state handling with retry visibility in ProgressTracker, JiraService callback support, and failure action buttons in approval flow**

## Performance

- **Duration:** 8 min
- **Started:** 2026-01-15T12:10:00Z
- **Completed:** 2026-01-15T12:18:00Z
- **Tasks:** 3
- **Files modified:** 4

## Accomplishments
- Added set_error() and set_failure() methods to ProgressTracker for error visibility
- Implemented progress_callback in JiraService._request() for timeout, rate_limit, and api_error types
- Integrated retry visibility into approval flow with on_jira_retry callback
- Added _post_error_actions() with Retry/Skip/Cancel buttons after failures

## Task Commits

Each task was committed atomically:

1. **Task 1: Add error state handling to ProgressTracker** - `dac84d1` (feat)
2. **Task 2: Add retry visibility to Jira client** - `6c08965` (feat)
3. **Task 3: Wire error handling into approval flow** - `ea145c5` (feat)

**Plan metadata:** Pending docs commit

## Files Created/Modified
- `src/slack/progress.py` - Added set_error(), set_failure(), _post_failure_status(), _update_failure_status()
- `src/jira/client.py` - Added progress_callback to _request() and create_issue(), handles timeout/rate_limit/api_error
- `src/slack/handlers.py` - Added ProgressTracker to approval flow, on_jira_retry callback, _post_error_actions()
- `src/skills/jira_create.py` - Added progress_callback parameter passed through to create_issue()

## Decisions Made
- **Callback as optional parameter**: Progress callback is optional in all methods to maintain backward compatibility with existing code
- **Factual error tone**: Error messages follow CONTEXT.md guidelines - state what failed, no apologies
- **Failure persists**: set_failure() does not auto-delete the status message so users can see what went wrong
- **Three action buttons**: Retry (try again), Skip Jira (continue without), Cancel (abort) - covers all reasonable user choices

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None.

## Next Phase Readiness
- Error handling protocol complete
- Ready for draft state badges (11.2-03) if planned
- All retry visibility infrastructure in place for any service integration

---
*Phase: 11.2-progress-status-indicators*
*Completed: 2026-01-15*
